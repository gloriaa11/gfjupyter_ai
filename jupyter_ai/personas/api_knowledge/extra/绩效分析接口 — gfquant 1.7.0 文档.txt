
绩效分析接口
View page source
绩效分析接口
¶
以下是绩效分析模块主要接口的示例代码。相关API文档链接：
Analyzer
[1]:
import
gfquant
gfquant
.
__version__
[1]:
'1.6.9'
[2]:
import
pandas
as
pd
import
matplotlib.pyplot
as
plt
from
gfquant
import
Analyzer
ana
=
Analyzer
()
年度绩效计算
¶
[3]:
# 假设上传了一个“组合1.pkl”，内容如下
pf
=
pd
.
read_pickle
(
'组合1.pkl'
)
display
(
pf
.
head
())
display
(
pf
.
tail
())
pf
.
shape
rtn
turnover
bench_rtn
2009-12-31
0.000000
0.9996
0.000000
2010-01-04
-0.013152
0.0000
-0.007381
2010-01-05
0.009260
0.0000
0.008681
2010-01-06
-0.005443
0.0000
-0.005158
2010-01-07
-0.017728
0.0000
-0.019885
rtn
turnover
bench_rtn
2019-06-24
0.002442
0.000000
0.001696
2019-06-25
-0.008476
0.000000
-0.010152
2019-06-26
0.000587
0.000000
-0.001623
2019-06-27
0.008160
0.000000
0.010716
2019-06-28
-0.001737
0.150022
-0.003737
[3]:
(2306, 3)
[4]:
# 分年度计算绩效
ana
.
daily_return_annual_perf
(
pf
[
'rtn'
],
pf
[
'bench_rtn'
],
pf
[
'turnover'
])
[4]:
2010
2011
2012
2013
2014
2015
2016
2017
2018
2019
区间年化
开始日期
2010-01-04
2011-01-04
2012-01-04
2013-01-04
2014-01-02
2015-01-05
2016-01-04
2017-01-03
2018-01-02
2019-01-02
2010-01-04
结束日期
2010-12-31
2011-12-30
2012-12-31
2013-12-31
2014-12-31
2015-12-31
2016-12-30
2017-12-29
2018-12-28
2019-06-28
2019-06-28
交易日数
242
244
243
238
245
244
244
244
243
118
2305
组合收益
-0.129328
-0.170235
0.189741
-0.0201646
0.733595
0.25866
-0.0230953
0.343833
-0.170263
0.273403
0.106816
波动率
0.25018
0.202783
0.204923
0.204341
0.202235
0.404896
0.23026
0.102888
0.207539
0.160255
0.238641
夏普比率
-0.516941
-0.839496
0.925912
-0.0986811
3.62745
0.638829
-0.100301
3.34182
-0.820392
1.70605
0.4476
最大回撤
-0.28794
-0.279785
-0.185491
-0.195601
-0.096603
-0.400768
-0.241646
-0.0549229
-0.269879
-0.132435
-0.402095
基准收益
-0.0648411
-0.265943
0.0770654
-0.000558124
0.516592
0.16342
-0.117021
0.171108
-0.259503
0.26383
0.0255391
超额收益
-0.0644873
0.0957077
0.112675
-0.0196065
0.217003
0.0952392
0.0939256
0.172725
0.0892396
0.00957246
0.0812765
跟踪误差
0.0495707
0.0358374
0.0330566
0.0503671
0.062558
0.108681
0.0504993
0.0497243
0.0433977
0.0323647
0.0580932
信息比率
-1.39933
3.57296
3.13151
-0.444688
2.3339
0.754895
2.037
2.9423
2.73155
0.156833
1.33992
超额最大回撤
-0.0770537
-0.0195057
-0.0182212
-0.0607766
-0.0359101
-0.0744279
-0.0272162
-0.0304764
-0.0363179
-0.0439878
-0.0770537
超额日胜率
0.392562
0.561475
0.555556
0.42437
0.493878
0.45082
0.516393
0.545082
0.55144
0.5
0.499349
超额周胜率
0.333333
0.627451
0.607843
0.384615
0.54717
0.423077
0.54
0.54902
0.607843
0.44
0.507216
超额月胜率
0.333333
0.583333
0.833333
0.333333
0.5
0.666667
0.833333
0.833333
0.75
0.666667
0.631579
双边换手率
5.15376
5.15072
5.89615
6.09748
5.01538
4.92905
4.56736
4.44855
3.97646
2.18285
5.14292
[5]:
# 同一组合把基准改为"中证800全收益"计算绩效
ana
.
daily_return_annual_perf
(
pf
[
'rtn'
],
bench_rtn
=
'h00906.CSI'
)
.
T
[5]:
开始日期
结束日期
交易日数
组合收益
波动率
夏普比率
最大回撤
基准收益
超额收益
跟踪误差
信息比率
超额最大回撤
超额日胜率
超额周胜率
超额月胜率
2010
2010-01-04
2010-12-31
242
-0.129328
0.25018
-0.516941
-0.28794
-0.0648411
-0.0644873
0.0495707
-1.39933
-0.0770537
0.392562
0.333333
0.333333
2011
2011-01-04
2011-12-30
244
-0.170235
0.202783
-0.839496
-0.279785
-0.265943
0.0957077
0.0358374
3.57296
-0.0195057
0.561475
0.627451
0.583333
2012
2012-01-04
2012-12-31
243
0.189741
0.204923
0.925912
-0.185491
0.0770654
0.112675
0.0330566
3.13151
-0.0182212
0.555556
0.607843
0.833333
2013
2013-01-04
2013-12-31
238
-0.0201646
0.204341
-0.0986811
-0.195601
-0.000558124
-0.0196065
0.0503671
-0.444688
-0.0607766
0.42437
0.384615
0.333333
2014
2014-01-02
2014-12-31
245
0.733595
0.202235
3.62745
-0.096603
0.516592
0.217003
0.062558
2.3339
-0.0359101
0.493878
0.54717
0.5
2015
2015-01-05
2015-12-31
244
0.25866
0.404896
0.638829
-0.400768
0.16342
0.0952392
0.108681
0.754895
-0.0744279
0.45082
0.423077
0.666667
2016
2016-01-04
2016-12-30
244
-0.0230953
0.23026
-0.100301
-0.241646
-0.117021
0.0939256
0.0504993
2.037
-0.0272162
0.516393
0.54
0.833333
2017
2017-01-03
2017-12-29
244
0.343833
0.102888
3.34182
-0.0549229
0.171108
0.172725
0.0497243
2.9423
-0.0304764
0.545082
0.54902
0.833333
2018
2018-01-02
2018-12-28
243
-0.170263
0.207539
-0.820392
-0.269879
-0.259503
0.0892396
0.0433977
2.73155
-0.0363179
0.55144
0.607843
0.75
2019
2019-01-02
2019-06-28
118
0.273403
0.160255
1.70605
-0.132435
0.26383
0.00957246
0.0323647
0.156833
-0.0439878
0.5
0.44
0.666667
区间年化
2010-01-04
2019-06-28
2305
0.106816
0.238641
0.4476
-0.402095
0.0255391
0.0812765
0.0580932
1.33992
-0.0770537
0.499349
0.507216
0.631579
敞口分析
¶
[6]:
# 假设上传了一个“持仓1.pkl”，内容如下
hold
=
pd
.
read_pickle
(
'持仓1.pkl'
)
hold
.
tail
()
[6]:
date
code
shares
price
weight
128375
2019-06-28
601899.SH
1.536822e+06
3.77
0.02273
128376
2019-06-28
601933.SH
1.969776e+05
10.21
0.00789
128377
2019-06-28
601988.SH
1.796568e+06
3.74
0.02636
128378
2019-06-28
603156.SH
1.461495e+05
37.08
0.02126
128379
2019-06-28
603833.SH
2.581660e+03
107.62
0.00109
[7]:
day
=
'2019-06-28'
day_hold
=
hold
.
set_index
(
'date'
)
.
loc
[
day
]
.
set_index
(
'code'
)[
'weight'
]
day_hold
.
head
()
.
to_frame
()
[7]:
weight
code
000100.SZ
0.022910
000157.SZ
0.019900
000333.SZ
0.007679
000651.SZ
0.041360
000656.SZ
0.001729
[8]:
# 计算行业和风格敞口
sector_exp
,
factor_exp
=
ana
.
portfolio_exposure
(
day
,
day_hold
,
'HS300'
,
portfolio_names
=
'红利价值'
)
[9]:
sector_exp
[9]:
行业暴露(基准HS300)
红利价值(超额暴露)
2019-06-28
交通运输
0.03187
-1.706294e-04
传媒
0.01395
5.869602e-03
公用事业
0.02269
8.846807e-04
农林牧渔
0.01964
-3.945619e-07
医药生物
0.06297
-6.512460e-04
商贸零售
0.00789
-1.588853e-07
国防军工
0.01421
-3.202779e-04
基础化工
0.01764
-4.300264e-03
家用电器
0.04904
-9.805046e-07
建筑材料
0.01182
9.797452e-04
建筑装饰
0.03034
-6.001960e-04
房地产
0.04563
2.790805e-04
有色金属
0.02235
3.795454e-04
机械设备
0.01990
-3.976339e-07
汽车
0.02651
3.947143e-05
煤炭
0.00989
-1.969686e-07
环保
0.00119
-1.190000e-03
电力设备
0.01778
-3.562621e-07
电子
0.03258
-9.670058e-03
石油石化
0.01335
3.509665e-03
社会服务
0.00834
-1.666530e-07
纺织服饰
0.00132
-2.661508e-08
综合
0.00176
-3.480402e-08
美容护理
0.00000
0.000000e+00
计算机
0.03469
4.789213e-03
轻工制造
0.00109
-2.205436e-08
通信
0.01608
4.389587e-03
钢铁
0.01008
-2.007078e-07
银行
0.16999
-3.405599e-06
非银金融
0.18726
-5.873642e-03
食品饮料
0.09817
2.480306e-04
[10]:
factor_exp
[10]:
大类
因子
因子暴露(基准HS300)
红利价值(超额暴露)
0
估值
BP
-0.320948
0.394469
1
估值
BP_FY1
-0.338155
0.678136
2
估值
BP_LR
-0.356346
0.405765
3
估值
BP_LR_Quantile_250D
-0.326322
0.361671
4
估值
BP_LR_Quantile_750D
-0.576870
0.424808
5
估值
CFP
-0.175039
0.174824
6
估值
EBITDA_TTM2EV
-0.220914
0.406097
7
估值
EP_FWD12M
0.176341
0.814895
8
估值
EP_FY1
0.174813
0.835749
9
估值
EP_FY2
0.171949
0.767467
10
估值
EP_TTM
-0.289467
0.478171
11
估值
EP_TTM_Deducted
-0.251713
0.419596
12
估值
EP_TTM_Quantile_250D
-0.340932
0.302006
13
估值
EP_TTM_Quantile_750D
-0.445991
0.448509
14
估值
FCFP_Q
-0.126228
0.314880
15
估值
FCFP_TTM
-0.349701
0.203765
16
估值
OCFP_Q
-0.093213
0.340810
17
估值
Q_EP
-0.320723
0.497957
18
估值
Q_SP
-0.111887
0.402954
19
估值
SP
-0.130862
0.402786
20
估值
SP_FWD12M
-0.138128
0.556695
21
估值
SP_FY1
-0.107379
0.371199
22
估值
SP_FY2
-0.142299
0.363113
23
估值
SP_TTM
-0.124403
0.408819
24
成长
GPOA_TTM_Delta
-0.111298
0.019591
25
成长
NETPROFIT_FY1_YOY
-0.146023
-0.357396
26
成长
NetProfit_Deducted_Q_YOY
-0.200293
-0.004712
27
成长
NetProfit_FY1_FY0
-0.133071
-0.328406
28
成长
NetProfit_FY2_FY1
-0.065344
-0.494933
29
成长
NetProfit_Q_QOQ
-0.142453
-0.032213
...
...
...
...
...
108
流动性
ILLIQ_1M_INVERSE
-0.825525
0.064991
109
流动性
ILLIQ_3M_INVERSE
-0.926602
0.071912
110
流动性
TURNOVER_120D
-0.163874
-0.097938
111
陆股通
SHSC_CHG_AMOUNT_1M
-0.373656
0.053597
112
陆股通
SHSC_CHG_AMOUNT_3M
-0.381735
0.009855
113
陆股通
SHSC_DELTA_RATIO_1M
-0.009586
0.159437
114
陆股通
SHSC_DELTA_RATIO_3M
-0.464286
0.115807
115
陆股通
SHSC_HOLD_AMOUNT
-0.248449
0.097467
116
陆股通
SHSC_HOLD_RATIO
0.447571
-0.025221
117
BARRA
BARRA_SIZE
0.846348
-0.057472
118
BARRA
BARRA_BETA
-0.099726
-0.301110
119
BARRA
BARRA_MOMENTUM
0.384613
-0.171092
120
BARRA
BARRA_RESVOL
-0.008761
-0.242522
121
BARRA
BARRA_NLSIZE
-0.424548
0.045696
122
BARRA
BARRA_BTOP
-0.074394
0.338784
123
BARRA
BARRA_LIQUIDITY
0.399144
-0.181027
124
BARRA
BARRA_EARNYIELD
0.178896
0.460398
125
BARRA
BARRA_GROWTH
0.154614
-0.143668
126
BARRA
BARRA_LEVERAGE
0.368042
0.036403
127
公司治理
DIVIDEND_PAYMENT_RATIO_1Y
-0.008256
0.142698
128
公司治理
DIVIDEND_PAYMENT_RATIO_3Y
-0.021379
0.283058
129
公司治理
MR
-0.201739
0.168518
130
公司治理
TOP10_SHAREHOLD_RATIO
-0.452853
0.189575
131
公司治理
TOP5_SHAREHOLD_RATIO
-0.452853
0.189575
132
其他
AVGAMOUNT_1MTO12M
0.062403
-0.117297
133
其他
AVGAMOUNT_1MTO3M
0.132790
-0.136607
134
其他
AVG_MAXRTN_3M
-0.129352
-0.306492
135
其他
DUVOL_3M
-0.016137
-0.179763
136
规模
LN_DQ_MV
1.951796
-0.015193
137
规模
LN_VAL_MV
1.845853
-0.041447
138 rows × 4 columns
Brinson归因分析
¶
brinson_single()
单期Brinson归因分析
brinson_multi()
多期Brinson归因分析
[11]:
# 单期 Brinson归因
ana
.
brinson_single
(
day_hold
,
day
,
pd
.
to_datetime
(
day
)
+
pd
.
Timedelta
(
days
=
35
),
'HS300'
,
sector
=
'LEVEL_1_SW'
,
full_pos
=
True
)
[11]:
Wp
Wb
Rp
Rb
I
II
III
IV
Alloc
Select
Inter
Total
交通运输
0.031744
0.032489
-0.036202
-0.034286
-0.001114
-0.001088
-0.001176
-0.001149
2.556792e-05
-0.000062
1.428879e-06
-3.525562e-05
休闲服务
0.008351
0.008340
0.020531
0.035580
0.000297
0.000297
0.000171
0.000171
4.142376e-07
-0.000126
-1.752053e-07
-1.252665e-04
传媒
0.019847
0.019130
-0.061710
-0.010381
-0.000199
-0.000206
-0.001180
-0.001225
-7.449944e-06
-0.000982
-3.683672e-05
-1.026200e-03
公用事业
0.023608
0.024630
0.090703
0.057111
0.001407
0.001348
0.002234
0.002141
-5.836297e-05
0.000827
-3.432835e-05
7.346658e-04
农林牧渔
0.019667
0.019640
0.000000
0.182681
0.003588
0.003593
0.000000
0.000000
5.008149e-06
-0.003588
-5.008149e-06
-3.587783e-03
化工
0.030242
0.023360
-0.027332
-0.045181
-0.001055
-0.001366
-0.000638
-0.000827
-3.109380e-04
0.000417
1.228416e-04
2.288628e-04
医药生物
0.062406
0.062969
-0.024272
-0.012584
-0.000792
-0.000785
-0.001528
-0.001515
7.084788e-06
-0.000736
6.579985e-06
-7.222856e-04
商业贸易
0.007901
0.008580
-0.078378
-0.078960
-0.000677
-0.000624
-0.000672
-0.000619
5.361195e-05
0.000005
-3.955313e-07
5.821454e-05
国防军工
0.013909
0.011190
0.014467
0.018595
0.000208
0.000259
0.000162
0.000201
5.056681e-05
-0.000046
-1.122534e-05
-6.849620e-06
家用电器
0.049107
0.049039
-0.021386
-0.017327
-0.000850
-0.000851
-0.001049
-0.001050
-1.186171e-06
-0.000199
-2.778871e-07
-2.005257e-04
建筑材料
0.012818
0.009580
-0.070587
-0.054458
-0.000522
-0.000698
-0.000676
-0.000905
-1.763258e-04
-0.000155
-5.222111e-05
-3.830554e-04
建筑装饰
0.029781
0.030339
0.004776
-0.017673
-0.000536
-0.000526
0.000145
0.000142
9.863052e-06
0.000681
-1.252816e-05
6.784226e-04
房地产
0.045973
0.045629
0.045537
-0.021484
-0.000980
-0.000988
0.002078
0.002093
-7.392384e-06
0.003058
2.306089e-05
3.073805e-03
有色金属
0.022761
0.024330
-0.022440
-0.038871
-0.000946
-0.000885
-0.000546
-0.000511
6.095958e-05
0.000400
-2.576770e-05
4.349498e-04
机械设备
0.019927
0.018060
-0.009969
0.015601
0.000282
0.000311
-0.000180
-0.000199
2.913783e-05
-0.000462
-4.775653e-05
-4.803877e-04
汽车
0.026587
0.026829
-0.002540
0.007300
0.000196
0.000194
-0.000068
-0.000068
-1.773368e-06
-0.000264
2.390517e-06
-2.633949e-04
电子
0.040365
0.044399
0.034137
0.063426
0.002816
0.002560
0.001516
0.001378
-2.558388e-04
-0.001300
1.181441e-04
-1.438130e-03
电气设备
0.017804
0.020930
-0.017162
0.023939
0.000501
0.000426
-0.000359
-0.000306
-7.481344e-05
-0.000860
1.284455e-04
-8.065950e-04
纺织服装
0.001322
0.001320
-0.026385
-0.026385
-0.000035
-0.000035
-0.000035
-0.000035
-4.861253e-08
0.000000
0.000000e+00
-4.861253e-08
综合
0.001762
0.001760
-0.020268
-0.056163
-0.000099
-0.000099
-0.000036
-0.000036
-1.380081e-07
0.000063
8.820518e-08
6.312516e-05
计算机
0.022111
0.022570
-0.042962
-0.009616
-0.000217
-0.000213
-0.000970
-0.000950
4.411349e-06
-0.000753
1.529806e-05
-7.328958e-04
轻工制造
0.001091
0.001090
-0.077514
-0.077514
-0.000084
-0.000085
-0.000084
-0.000085
-1.179252e-07
0.000000
0.000000e+00
-1.179252e-07
通信
0.020498
0.017770
-0.046210
-0.044197
-0.000785
-0.000906
-0.000821
-0.000947
-1.205920e-04
-0.000036
-5.493438e-06
-1.618618e-04
采掘
0.009904
0.017580
-0.068160
-0.039953
-0.000702
-0.000396
-0.001198
-0.000675
3.066806e-04
-0.000496
2.165183e-04
2.732916e-05
钢铁
0.010094
0.008910
-0.049026
-0.055682
-0.000496
-0.000562
-0.000437
-0.000495
-6.593009e-05
0.000059
7.881194e-06
1.256122e-06
银行
0.170224
0.169987
-0.004802
0.001109
0.000189
0.000189
-0.000816
-0.000817
2.632483e-07
-0.001005
-1.402640e-06
-1.005935e-03
非银金融
0.181640
0.181386
-0.035043
-0.043065
-0.007811
-0.007822
-0.006356
-0.006365
-1.090384e-05
0.001455
2.031041e-06
1.446131e-03
食品饮料
0.098555
0.098168
-0.071003
-0.038068
-0.003737
-0.003752
-0.006970
-0.006998
-1.474683e-05
-0.003233
-1.275863e-05
-3.260709e-03
[12]:
# 示例：间隔60交易日，取最近10期的持仓样本
days_select
=
sorted
(
set
(
hold
[
'date'
]))[::
60
][
-
10
:]
end_day
=
hold
[
'date'
]
.
max
()
hold_select
=
hold
.
loc
[
hold
[
'date'
]
.
isin
(
days_select
),
[
'date'
,
'code'
,
'weight'
]]
hold_select
.
columns
=
[
'调整日期'
,
'证券代码'
,
'持仓权重'
]
# 与调仓文件列名一致
print
(
pd
.
to_datetime
(
days_select
)
)
# 多期 Brinson归因
brinson_multi
,
list_of_dict
=
ana
.
brinson_multi
(
hold_select
,
end_day
,
bench
=
'HS300'
,
split_sectors
=
[
'非银金融'
],
full_pos
=
True
)
brinson_multi
DatetimeIndex(['2017-03-06', '2017-06-05', '2017-08-28', '2017-11-27',
'2018-02-27', '2018-05-28', '2018-08-21', '2018-11-21',
'2019-02-22', '2019-05-23'],
dtype='datetime64[ns]', freq=None)
[12]:
I
II
III
IV
Alloc
Select
Inter
Total
医药生物
0.007562
0.008911
-0.017162
-0.015609
0.001349
-0.024723
0.000203
-0.023171
食品饮料
0.070361
0.068865
0.054379
0.053275
-0.001497
-0.015982
0.000392
-0.017087
多元金融Ⅱ
-0.002253
-0.005465
-0.002993
-0.011807
-0.003212
-0.000740
-0.005603
-0.009555
保险Ⅱ
0.067440
0.058034
0.071823
0.062958
-0.009407
0.004383
0.000542
-0.004482
房地产
0.011730
0.011385
0.008948
0.008400
-0.000345
-0.002781
-0.000204
-0.003330
电气设备
-0.001236
-0.002462
-0.005251
-0.003391
-0.001227
-0.004015
0.003087
-0.002155
国防军工
-0.007469
-0.012703
-0.005731
-0.009450
-0.005234
0.001739
0.001515
-0.001981
银行
0.036174
0.035192
0.035554
0.034300
-0.000982
-0.000620
-0.000272
-0.001874
商业贸易
-0.001144
-0.000619
-0.003603
-0.002585
0.000525
-0.002459
0.000494
-0.001441
建筑材料
0.005518
0.003950
0.004096
0.004184
-0.001568
-0.001422
0.001656
-0.001334
轻工制造
-0.001206
-0.001060
-0.001774
-0.001690
0.000147
-0.000568
-0.000062
-0.000484
综合
-0.004377
-0.003964
-0.004677
-0.004279
0.000414
-0.000299
-0.000015
0.000099
纺织服装
-0.001499
-0.001136
-0.000721
-0.000711
0.000363
0.000778
-0.000353
0.000789
有色金属
-0.008217
-0.008872
-0.004956
-0.006725
-0.000655
0.003262
-0.001115
0.001493
化工
0.001037
0.001030
0.003091
0.002593
-0.000007
0.002054
-0.000492
0.001555
休闲服务
0.006623
0.006551
0.009302
0.009209
-0.000072
0.002679
-0.000021
0.002586
交通运输
0.003388
0.003291
0.006671
0.006669
-0.000097
0.003284
0.000094
0.003281
通信
-0.000734
-0.000200
0.001595
0.002579
0.000533
0.002329
0.000450
0.003313
钢铁
-0.000814
-0.000801
0.002937
0.003198
0.000012
0.003751
0.000249
0.004012
农林牧渔
0.005585
0.005613
0.010054
0.009806
0.000027
0.004468
-0.000275
0.004221
公用事业
-0.002039
-0.001796
0.003271
0.002741
0.000243
0.005310
-0.000773
0.004780
家用电器
0.026638
0.025855
0.033657
0.032716
-0.000783
0.007019
-0.000158
0.006078
采掘
-0.001313
-0.000973
0.009095
0.004931
0.000340
0.010408
-0.004503
0.006244
证券Ⅱ
-0.009294
-0.015285
0.000820
-0.002732
-0.005991
0.010113
0.002440
0.006562
电子
-0.005684
-0.009447
0.008236
0.002324
-0.003763
0.013920
-0.002149
0.008007
建筑装饰
-0.009378
-0.009269
-0.001247
-0.001159
0.000110
0.008131
-0.000021
0.008219
汽车
0.001735
0.001745
0.012628
0.013414
0.000010
0.010893
0.000775
0.011678
机械设备
-0.000364
0.004233
0.008126
0.011371
0.004596
0.008489
-0.001351
0.011734
计算机
0.008082
0.010429
0.022694
0.026865
0.002347
0.014611
0.001824
0.018783
传媒
-0.016971
-0.016254
0.004681
0.004954
0.000717
0.021652
-0.000444
0.021924
Sum
0.177883
0.154776
0.263546
0.236348
-0.023107
0.085663
-0.004091
0.058466
其它分析接口
¶
[13]:
# 日收益序列转换为日净值序列
ana
.
daily_return_to_nav
(
pf
[
'rtn'
])
.
tail
()
.
to_frame
(
'nav'
)
[13]:
nav
2019-06-24
2.552947
2019-06-25
2.531309
2019-06-26
2.532794
2019-06-27
2.553461
2019-06-28
2.549026
[14]:
# 回撤曲线和详情计算
dds
,
ddf
=
ana
.
nav_drawdown
(
ana
.
daily_return_to_nav
(
pf
[
'rtn'
]),
dd_threshold
=
0.05
)
# 日回撤Series画图
dds
.
plot
(
figsize
=
(
12
,
5
))
plt
.
show
()
# 显示回撤详情DataFrame
ddf
[14]:
active
start_day
low_day
end_day
start_value
low_value
down_duration
duration
drawdown
0
0
2015-06-09
2016-01-28
2017-10-11
2.330829
1.393615
159
570
-0.402095
1
0
2010-01-04
2012-01-05
2014-10-31
1.000000
0.702190
488
1168
-0.297810
2
0
2018-01-24
2018-10-18
2019-04-09
2.673885
1.952259
176
290
-0.269879
3
1
2019-04-22
2019-05-23
NaT
2.733208
2.371235
21
46
-0.132435
4
0
2015-01-19
2015-02-06
2015-03-02
1.534340
1.404664
15
25
-0.084516
5
0
2015-05-05
2015-05-07
2015-05-21
2.029317
1.888719
3
12
-0.069283
6
0
2015-05-28
2015-05-28
2015-06-02
2.202426
2.060707
1
3
-0.064347
7
0
2014-12-09
2014-12-09
2014-12-16
1.349987
1.274890
1
5
-0.055627
8
0
2014-12-23
2014-12-24
2014-12-26
1.400582
1.323261
2
3
-0.055207
9
0
2017-11-23
2017-12-18
2018-01-08
2.519045
2.380691
18
31
-0.054923
Next
Previous
© Copyright 2018-2022, GF Funds 量化投资部
Built with
Sphinx
using a
theme
provided by
Read the Docs
.